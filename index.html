<!doctype html>
<html><head>
<!-- {"messageType":"op", "op":{"objectId":"asdf"}} -->
<!-- {"messageType":"subscribe", "objectId":"asdf"} -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://cdn.jsdelivr.net/sockjs/1.0.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>
    <script src="/op.js"></script>
    <script src="/client.js"></script>

<style>
.color-button {
float: left; width: 50px; height: 50px; line-height: 50px; margin: 25px;
background-color: white;
text-align: center;
}
</style>

</head><body lang="en">
    <h1>Tytanic Example</h1>

    <div id="top" style="width: 300px; height: 100px; background-color: black">
      <div id="topRedButton" class="color-button">
        R
      </div>
      <div id="topGreenButton" class="color-button">
        G
      </div>
      <div id="topBlueButton" class="color-button">
        B
      </div>
    </div>
    <div id="bottom" style="width: 300px; height: 100px; background-color: black">
      <div id="bottomRedButton" class="color-button">
        R
      </div>
      <div id="bottomGreenButton" class="color-button">
        G
      </div>
      <div id="bottomBlueButton" class="color-button">
        B
      </div>
    </div>

    <script>
      var cli = new tytanic.client.Client();
      cli.changeHandler = function() {
        asdf = cli.objects.asdf || {};
        $('#top').css('background-color', asdf.topColor || 'black');
        $('#bottom').css('background-color', asdf.bottomColor || 'black');
      };
      cli.subscribe('asdf');
      cli.init();

      $('#topRedButton').click(function() {
        cli.run('set', 'asdf', ['topColor', 'red']);
      });
      $('#topGreenButton').click(function() {
        cli.run('set', 'asdf', ['topColor', 'green']);
      });
      $('#topBlueButton').click(function() {
        cli.run('set', 'asdf', ['topColor', 'blue']);
      });

      $('#bottomRedButton').click(function() {
        cli.run('set', 'asdf', ['bottomColor', 'red']);
      });
      $('#bottomGreenButton').click(function() {
        cli.run('set', 'asdf', ['bottomColor', 'green']);
      });
      $('#bottomBlueButton').click(function() {
        cli.run('set', 'asdf', ['bottomColor', 'blue']);
      });
    </script>
</body></html>
